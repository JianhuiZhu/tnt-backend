worker_processes 4;

events { worker_connections 1024; }


http{
    upstream tnt-app {
        server app:3000 weight=10 max_fails=3 fail_timeout=30s;
    }

    server {
        listen      80;
        charset     utf-8;
        server_name .localhost;
        client_max_body_size 75M;

        location / { try_files $uri @app; }
        location @app {
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            # enable this if and only if you use HTTPS
            # proxy_set_header X-Forwarded-Proto https;
            proxy_set_header Host $http_host;
            # we don't want nginx trying to do something clever with
            # redirects, we set the Host: header above already.
            proxy_redirect off;
            proxy_pass http://tnt-app;
        }

    }
}
